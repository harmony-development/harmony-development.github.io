<!DOCTYPE html>
<html lang="en-us"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <title>Server Name Resolution | Harmony</title>
    <meta name="description" content="Every Harmony homeserver is identified by a &ldquo;server name.&rdquo; A server name uniquely identifies a server, regardless of whether the resolved IP address changes or not. Two server names pointing to the same IP address would be considered two different homeservers.
A server name is resolved to an IP address and port using the following process:
When IP Address (xxx.xxx.xxx.xxx &#43; optional :port) When the server name is an IP address, this is the resolved IP of the server that requests should be sent to. ">
    <link rel="canonical" href="https://harmonyapp.io/docs/name-resolution/" />

    

    
      
      <link rel="stylesheet" href="/css/main.min.7cc14bd27d9ce04bbac7032144405e7348f78d90586d9ad05ee3c11a6840b91a.css" integrity="sha256-fMFL0n2c4Eu6xwMhREBec0j3jZBYbZrQXuPBGmhAuRo="/>
    

    <meta property="og:title" content="Server Name Resolution" />
<meta property="og:description" content="Every Harmony homeserver is identified by a &ldquo;server name.&rdquo; A server name uniquely identifies a server, regardless of whether the resolved IP address changes or not. Two server names pointing to the same IP address would be considered two different homeservers.
A server name is resolved to an IP address and port using the following process:
When IP Address (xxx.xxx.xxx.xxx &#43; optional :port) When the server name is an IP address, this is the resolved IP of the server that requests should be sent to." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://harmonyapp.io/docs/name-resolution/" />


    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Server Name Resolution"/>
<meta name="twitter:description" content="Every Harmony homeserver is identified by a &ldquo;server name.&rdquo; A server name uniquely identifies a server, regardless of whether the resolved IP address changes or not. Two server names pointing to the same IP address would be considered two different homeservers.
A server name is resolved to an IP address and port using the following process:
When IP Address (xxx.xxx.xxx.xxx &#43; optional :port) When the server name is an IP address, this is the resolved IP of the server that requests should be sent to."/>

    <meta name="theme-color" content="#E93D58">
    <meta property="og:image" content="https://harmonyapp.io/img/harmony-embed.png" />

    <script src="https://unpkg.com/quicklink@2.0.0/dist/quicklink.umd.js"></script>
    <script defer>
        quicklink.listen()
    </script>
</head>
<body class="dark:text-white"><header class="w-full bg-gray-200 header flex text-lg">
    <div class="flex flex-row w-full">
        <div class="flex-auto p-4 justify-start order-first inline-flex">
            <a class="font-header" href="/">
                <span class="font-light">Harmony </span><span class="font-bold">Chat</span>
            </a>
        </div>
        <div class="flex-auto p-4 justify-end order-last inline-flex">
        
        <a href="/docs" class="ml-2 nu-top-app-bar__link h1-minor-minor">
            <span>Docs</span>
        </a>
        
        <a href="https://github.com/harmony-development" class="ml-2 nu-top-app-bar__link h1-minor-minor">
            <span>Github</span>
        </a>
        
        </div>
    </div>
</header><main>

<div class="prose-wrapper mt-4">
    <aside class="prose-toc">
        <h4><strong>Table Of Contents</strong></h4>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#when-ip-address-xxxxxxxxxxxx--optional-port">When IP Address (<code>xxx.xxx.xxx.xxx</code> + optional <code>:port</code>)</a></li>
    <li><a href="#when-domain-and-port-examplecomport">When domain and port (<code>example.com:port</code>)</a></li>
    <li><a href="#when-domain-without-port-examplecom">When domain without port (<code>example.com</code>)</a></li>
  </ul>
</nav>
    </aside>
    <article class="prose">
        <h1 class="h1">Server Name Resolution</h1>
        <p>Every Harmony homeserver is identified by a &ldquo;server name.&rdquo; A server name uniquely identifies a server, regardless of whether the resolved IP address changes or not. Two server names pointing to the same IP address would be considered two different homeservers.</p>
<p>A server name is resolved to an IP address and port using the following process:</p>
<h2 id="when-ip-address-xxxxxxxxxxxx--optional-port">When IP Address (<code>xxx.xxx.xxx.xxx</code> + optional <code>:port</code>)</h2>
<p>When the server name is an IP address, this is the resolved IP of the server that requests should be sent to. If not specified, <code>:port</code> is 2289.</p>
<p>The <code>Host</code> header in requests should be set to the IP literal including the port if specified in the server name.</p>
<h2 id="when-domain-and-port-examplecomport">When domain and port (<code>example.com:port</code>)</h2>
<p>When the server name is a hostname with a port, the hostname should be resolved to an IP address using AAAA or A record lookups in the DNS. This IP address will be the one requests are sent to.</p>
<p>The <code>Host</code> header in requests should be set to the domain name and given port, not the resolved IP address.</p>
<h2 id="when-domain-without-port-examplecom">When domain without port (<code>example.com</code>)</h2>
<p>When the server name is a host without a port, a request should be made to <code>https://hostname/_harmony/server</code>. If the request fails with a 404, resolution of the server name should be done as if it had port 2289 specified using the above method for resolving domains with ports. Otherwise, the request is expected to return a JSON object with the following schema:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#f92672">&#34;h.server&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
}
</code></pre></div><p><code>h.server</code> should be either an IP address or a domain + port. It may not be another domain without a port. <code>h.server</code> should be resolved using the above two methods as per usual to an IP address. This IP address will be the one requests are sent to.</p>
<p>The <code>Host</code> header in requests should be set to the domain name without port.</p>

    </article>
</div>


        </main></body>
</html>
