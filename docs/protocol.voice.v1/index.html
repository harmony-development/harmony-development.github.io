<!DOCTYPE html>
<html lang="en-us"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <title>Reference: protocol.voice.v1 | Harmony</title>
    <meta name="description" content="Standalone Message Types UserConsumerOptions Data containing all the necessary information to create a consumer for a user in a voice channel
This corresponds to https://mediasoup.org/documentation/v3/mediasoup-client/api/#ConsumerOptions on client:
 consumer_id -&gt; id producer_id -&gt; producerId rtp_parameters -&gt; rtpParameters and kind should be set to &ldquo;audio&rdquo;.  Fields
user_id Type: optional uint64
User ID of the user.
producer_id Type: optional string
Producer ID of the producer being consumed.
consumer_id Type: optional string ">
    <link rel="canonical" href="https://harmonyapp.io/docs/protocol.voice.v1/" />

    <link rel="stylesheet" href="/css/codicon.css" />

    

    
      
      <link rel="stylesheet" href="/css/main.min.43ed3940f4fe2c2c0e39dc5b25b6738799dd574c50927c0b3de5236dc7f59adc.css" integrity="sha256-Q+05QPT+LCwOOdxbJbZzh5ndV0xQknwLPeUjbcf1mtw="/>
    

    <meta property="og:title" content="Reference: protocol.voice.v1" />
<meta property="og:description" content="Standalone Message Types UserConsumerOptions Data containing all the necessary information to create a consumer for a user in a voice channel
This corresponds to https://mediasoup.org/documentation/v3/mediasoup-client/api/#ConsumerOptions on client:
 consumer_id -&gt; id producer_id -&gt; producerId rtp_parameters -&gt; rtpParameters and kind should be set to &ldquo;audio&rdquo;.  Fields
user_id Type: optional uint64
User ID of the user.
producer_id Type: optional string
Producer ID of the producer being consumed.
consumer_id Type: optional string" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://harmonyapp.io/docs/protocol.voice.v1/" />


    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Reference: protocol.voice.v1"/>
<meta name="twitter:description" content="Standalone Message Types UserConsumerOptions Data containing all the necessary information to create a consumer for a user in a voice channel
This corresponds to https://mediasoup.org/documentation/v3/mediasoup-client/api/#ConsumerOptions on client:
 consumer_id -&gt; id producer_id -&gt; producerId rtp_parameters -&gt; rtpParameters and kind should be set to &ldquo;audio&rdquo;.  Fields
user_id Type: optional uint64
User ID of the user.
producer_id Type: optional string
Producer ID of the producer being consumed.
consumer_id Type: optional string"/>

    <meta name="theme-color" content="#E93D58">
    <meta property="og:image" content="https://harmonyapp.io/img/harmony-embed.png" />

    <script src="https://unpkg.com/quicklink@2.0.0/dist/quicklink.umd.js"></script>
    <script defer>
        quicklink.listen()
    </script>
</head>
<body class="dark:text-white"><header class="w-full bg-gray-200 header flex text-lg">
  <div class="flex flex-row w-full items-center">
    <div class="flex-auto px-3 justify-start order-first inline-flex">
      <a class="font-header" href="/">
        <span class="font-light">Harmony </span
        ><span class="font-bold">Chat</span>
      </a>
    </div>
    <div class="flex-auto p-2 justify-end order-last inline-flex gap-1">
      
      <a
        href="/docs/faq"
        class="
          ml-2
          nu-top-app-bar__link
          h1-minor-minor
          border-2 border-transparent
          px-2
          hover:border-current hover:bg-white hover:bg-opacity-5
          rounded-sm
          transition
          duration-100
        "
      >
        FAQ
      </a>
      
      <a
        href="/docs"
        class="
          ml-2
          nu-top-app-bar__link
          h1-minor-minor
          border-2 border-transparent
          px-2
          hover:border-current hover:bg-white hover:bg-opacity-5
          rounded-sm
          transition
          duration-100
        "
      >
        Docs
      </a>
      
      <a
        href="https://github.com/harmony-development"
        class="
          ml-2
          nu-top-app-bar__link
          h1-minor-minor
          border-2 border-transparent
          px-2
          hover:border-current hover:bg-white hover:bg-opacity-5
          rounded-sm
          transition
          duration-100
        "
      >
        Github
      </a>
      
    </div>
  </div>
</header>
<main>

<div class="prose-wrapper">
  <aside class="prose-toc">
    <h4><strong>Table Of Contents</strong></h4>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#standalone-message-types">Standalone Message Types</a>
      <ul>
        <li><a href="#span-classcodicon-codicon-symbol-structure-symbol-structurespanuserconsumeroptions"><span class="codicon codicon-symbol-structure symbol-structure"></span>UserConsumerOptions</a>
          <ul>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanuser_id"><span class="codicon codicon-symbol-field symbol-field"></span>user_id</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanproducer_id"><span class="codicon codicon-symbol-field symbol-field"></span>producer_id</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanconsumer_id"><span class="codicon codicon-symbol-field symbol-field"></span>consumer_id</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanrtp_parameters"><span class="codicon codicon-symbol-field symbol-field"></span>rtp_parameters</a></li>
          </ul>
        </li>
        <li><a href="#span-classcodicon-codicon-symbol-structure-symbol-structurespantransportoptions"><span class="codicon codicon-symbol-structure symbol-structure"></span>TransportOptions</a>
          <ul>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanid"><span class="codicon codicon-symbol-field symbol-field"></span>id</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspandtls_parameters"><span class="codicon codicon-symbol-field symbol-field"></span>dtls_parameters</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanice_candidates"><span class="codicon codicon-symbol-field symbol-field"></span>ice_candidates</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanice_parameters"><span class="codicon codicon-symbol-field symbol-field"></span>ice_parameters</a></li>
          </ul>
        </li>
        <li><a href="#span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessagerequest"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageRequest</a>
          <ul>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspaninitialize"><span class="codicon codicon-symbol-field symbol-field"></span>initialize</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanprepare_for_join_channel"><span class="codicon codicon-symbol-field symbol-field"></span>prepare_for_join_channel</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanjoin_channel"><span class="codicon codicon-symbol-field symbol-field"></span>join_channel</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanresume_consumer"><span class="codicon codicon-symbol-field symbol-field"></span>resume_consumer</a></li>
          </ul>
        </li>
        <li><a href="#span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessagerequestinitialize"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageRequest.Initialize</a>
          <ul>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanguild_id"><span class="codicon codicon-symbol-field symbol-field"></span>guild_id</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanchannel_id"><span class="codicon codicon-symbol-field symbol-field"></span>channel_id</a></li>
          </ul>
        </li>
        <li><a href="#span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessagerequestprepareforjoinchannel"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageRequest.PrepareForJoinChannel</a>
          <ul>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanrtp_capabilities"><span class="codicon codicon-symbol-field symbol-field"></span>rtp_capabilities</a></li>
          </ul>
        </li>
        <li><a href="#span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessagerequestjoinchannel"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageRequest.JoinChannel</a>
          <ul>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanrtp_paramaters"><span class="codicon codicon-symbol-field symbol-field"></span>rtp_paramaters</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanproducer_dtls_paramaters"><span class="codicon codicon-symbol-field symbol-field"></span>producer_dtls_paramaters</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanconsumer_dtls_paramaters"><span class="codicon codicon-symbol-field symbol-field"></span>consumer_dtls_paramaters</a></li>
          </ul>
        </li>
        <li><a href="#span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessagerequestresumeconsumer"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageRequest.ResumeConsumer</a>
          <ul>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanconsumer_id-1"><span class="codicon codicon-symbol-field symbol-field"></span>consumer_id</a></li>
          </ul>
        </li>
        <li><a href="#span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessageresponse"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageResponse</a>
          <ul>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspaninitialized"><span class="codicon codicon-symbol-field symbol-field"></span>initialized</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanprepared_for_join_channel"><span class="codicon codicon-symbol-field symbol-field"></span>prepared_for_join_channel</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanjoined_channel"><span class="codicon codicon-symbol-field symbol-field"></span>joined_channel</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanuser_joined"><span class="codicon codicon-symbol-field symbol-field"></span>user_joined</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanuser_left"><span class="codicon codicon-symbol-field symbol-field"></span>user_left</a></li>
          </ul>
        </li>
        <li><a href="#span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessageresponseinitialized"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageResponse.Initialized</a>
          <ul>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanrtp_capabilities-1"><span class="codicon codicon-symbol-field symbol-field"></span>rtp_capabilities</a></li>
          </ul>
        </li>
        <li><a href="#span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessageresponsepreparedforjoinchannel"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageResponse.PreparedForJoinChannel</a>
          <ul>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanconsumer_transport_options"><span class="codicon codicon-symbol-field symbol-field"></span>consumer_transport_options</a></li>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanproducer_transport_options"><span class="codicon codicon-symbol-field symbol-field"></span>producer_transport_options</a></li>
          </ul>
        </li>
        <li><a href="#span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessageresponsejoinedchannel"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageResponse.JoinedChannel</a>
          <ul>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanother_users"><span class="codicon codicon-symbol-field symbol-field"></span>other_users</a></li>
          </ul>
        </li>
        <li><a href="#span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessageresponseuserjoined"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageResponse.UserJoined</a>
          <ul>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspandata"><span class="codicon codicon-symbol-field symbol-field"></span>data</a></li>
          </ul>
        </li>
        <li><a href="#span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessageresponseuserleft"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageResponse.UserLeft</a>
          <ul>
            <li><a href="#span-classcodicon-codicon-symbol-field-symbol-fieldspanuser_id-1"><span class="codicon codicon-symbol-field symbol-field"></span>user_id</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#services">Services</a>
      <ul>
        <li><a href="#span-classcodicon-codicon-symbol-class-symbol-classspanvoiceservice"><span class="codicon codicon-symbol-class symbol-class"></span>VoiceService</a></li>
      </ul>
    </li>
    <li><a href="#usage-for-client">Usage (for client)</a>
      <ul>
        <li><a href="#how-this-looks-for-servers">How this looks for servers</a>
          <ul>
            <li>
              <ul>
                <li><a href="#span-classcodicon-codicon-symbol-method-symbol-methodspanstreammessage"><span class="codicon codicon-symbol-method symbol-method"></span>StreamMessage</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </aside>
  <div class="flex justify-center pb-8 w-full">
    <article class="prose">
      <h1 class="h1">Reference: protocol.voice.v1</h1>
      <h1 id="standalone-message-types">Standalone Message Types</h1>
<h2 id="span-classcodicon-codicon-symbol-structure-symbol-structurespanuserconsumeroptions"><span class="codicon codicon-symbol-structure symbol-structure"></span>UserConsumerOptions</h2>
<p>Data containing all the necessary information to
create a consumer for a user in a voice channel</p>
<p>This corresponds to <a href="https://mediasoup.org/documentation/v3/mediasoup-client/api/#ConsumerOptions">https://mediasoup.org/documentation/v3/mediasoup-client/api/#ConsumerOptions</a> on client:</p>
<ul>
<li><code>consumer_id</code> -&gt; <code>id</code></li>
<li><code>producer_id</code> -&gt; <code>producerId</code></li>
<li><code>rtp_parameters</code> -&gt; <code>rtpParameters</code></li>
<li>and <code>kind</code> should be set to &ldquo;audio&rdquo;.</li>
</ul>
<p><span class="h3" aria-level="3">Fields</span></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanuser_id"><span class="codicon codicon-symbol-field symbol-field"></span>user_id</h3>
<p>Type: optional <code>uint64</code></p>
<p>User ID of the user.</p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanproducer_id"><span class="codicon codicon-symbol-field symbol-field"></span>producer_id</h3>
<p>Type: optional <code>string</code></p>
<p>Producer ID of the producer being consumed.</p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanconsumer_id"><span class="codicon codicon-symbol-field symbol-field"></span>consumer_id</h3>
<p>Type: optional <code>string</code></p>
<p>Consumer ID for the user&rsquo;s producer consumer.</p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanrtp_parameters"><span class="codicon codicon-symbol-field symbol-field"></span>rtp_parameters</h3>
<p>Type: optional <code>string</code></p>
<p>RTP paramaters for the user&rsquo;s audio track. Corresponds to <code>RtpParameters</code> in mediasoup&rsquo;s TypeScript API.</p>
<hr>
<h2 id="span-classcodicon-codicon-symbol-structure-symbol-structurespantransportoptions"><span class="codicon codicon-symbol-structure symbol-structure"></span>TransportOptions</h2>
<p>Object containing all the necessary information about transport options required
from the server to establish transport connection on the client</p>
<p>This corresponds to <a href="https://mediasoup.org/documentation/v3/mediasoup-client/api/#TransportOptions">https://mediasoup.org/documentation/v3/mediasoup-client/api/#TransportOptions</a> on client:</p>
<ul>
<li><code>id</code> -&gt; <code>id</code></li>
<li><code>ice_parameters</code> -&gt; <code>iceParameters</code></li>
<li><code>dtls_parameters</code> -&gt; <code>dtlsParameters</code></li>
<li><code>ice_candidates</code> -&gt; <code>iceCandidates</code></li>
</ul>
<p><span class="h3" aria-level="3">Fields</span></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanid"><span class="codicon codicon-symbol-field symbol-field"></span>id</h3>
<p>Type: optional <code>string</code></p>
<p>The transport ID.</p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspandtls_parameters"><span class="codicon codicon-symbol-field symbol-field"></span>dtls_parameters</h3>
<p>Type: optional <code>string</code></p>
<p>DTLS paramaters in JSON. Corresponds to <code>DtlsParameters</code> in mediasoup&rsquo;s TypeScript API.</p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanice_candidates"><span class="codicon codicon-symbol-field symbol-field"></span>ice_candidates</h3>
<p>Type: repeated <code>string</code></p>
<p>ICE candidates in JSON. Corresponds to <code>IceCandidate</code> in mediasoup&rsquo;s TypeScript API.</p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanice_parameters"><span class="codicon codicon-symbol-field symbol-field"></span>ice_parameters</h3>
<p>Type: optional <code>string</code></p>
<p>ICE paramaters in JSON. Corresponds to <code>IceParameters</code> in mediasoup&rsquo;s TypeScript API.</p>
<hr>
<h2 id="span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessagerequest"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageRequest</h2>
<p>Used in <code>StreamMessage</code> endpoint.</p>
<p><span class="h3" aria-level="3">Fields</span></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspaninitialize"><span class="codicon codicon-symbol-field symbol-field"></span>initialize</h3>
<p>Type: optional <a href="#streammessagerequestinitialize">protocol.voice.v1.StreamMessageRequest.Initialize</a></p>
<p>Sent to initialize the WS and receive necessary information</p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanprepare_for_join_channel"><span class="codicon codicon-symbol-field symbol-field"></span>prepare_for_join_channel</h3>
<p>Type: optional <a href="#streammessagerequestprepareforjoinchannel">protocol.voice.v1.StreamMessageRequest.PrepareForJoinChannel</a></p>
<p>Sent to prepare for joining channel</p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanjoin_channel"><span class="codicon codicon-symbol-field symbol-field"></span>join_channel</h3>
<p>Type: optional <a href="#streammessagerequestjoinchannel">protocol.voice.v1.StreamMessageRequest.JoinChannel</a></p>
<p>Sent to join a channel</p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanresume_consumer"><span class="codicon codicon-symbol-field symbol-field"></span>resume_consumer</h3>
<p>Type: optional <a href="#streammessagerequestresumeconsumer">protocol.voice.v1.StreamMessageRequest.ResumeConsumer</a></p>
<p>Sent to resume a consumer</p>
<hr>
<h2 id="span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessagerequestinitialize"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageRequest.Initialize</h2>
<p><span class="h3" aria-level="3">Fields</span></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanguild_id"><span class="codicon codicon-symbol-field symbol-field"></span>guild_id</h3>
<p>Type: optional <code>uint64</code></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanchannel_id"><span class="codicon codicon-symbol-field symbol-field"></span>channel_id</h3>
<p>Type: optional <code>uint64</code></p>
<hr>
<h2 id="span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessagerequestprepareforjoinchannel"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageRequest.PrepareForJoinChannel</h2>
<p><span class="h3" aria-level="3">Fields</span></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanrtp_capabilities"><span class="codicon codicon-symbol-field symbol-field"></span>rtp_capabilities</h3>
<p>Type: optional <code>string</code></p>
<hr>
<h2 id="span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessagerequestjoinchannel"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageRequest.JoinChannel</h2>
<p><span class="h3" aria-level="3">Fields</span></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanrtp_paramaters"><span class="codicon codicon-symbol-field symbol-field"></span>rtp_paramaters</h3>
<p>Type: optional <code>string</code></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanproducer_dtls_paramaters"><span class="codicon codicon-symbol-field symbol-field"></span>producer_dtls_paramaters</h3>
<p>Type: optional <code>string</code></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanconsumer_dtls_paramaters"><span class="codicon codicon-symbol-field symbol-field"></span>consumer_dtls_paramaters</h3>
<p>Type: optional <code>string</code></p>
<hr>
<h2 id="span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessagerequestresumeconsumer"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageRequest.ResumeConsumer</h2>
<p><span class="h3" aria-level="3">Fields</span></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanconsumer_id-1"><span class="codicon codicon-symbol-field symbol-field"></span>consumer_id</h3>
<p>Type: optional <code>string</code></p>
<hr>
<h2 id="span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessageresponse"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageResponse</h2>
<p>Used in <code>StreamMessage</code> endpoint.</p>
<p><span class="h3" aria-level="3">Fields</span></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspaninitialized"><span class="codicon codicon-symbol-field symbol-field"></span>initialized</h3>
<p>Type: optional <a href="#streammessageresponseinitialized">protocol.voice.v1.StreamMessageResponse.Initialized</a></p>
<p>Sent when connection is started</p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanprepared_for_join_channel"><span class="codicon codicon-symbol-field symbol-field"></span>prepared_for_join_channel</h3>
<p>Type: optional <a href="#streammessageresponsepreparedforjoinchannel">protocol.voice.v1.StreamMessageResponse.PreparedForJoinChannel</a></p>
<p>Sent when preparing to join a channel is successful</p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanjoined_channel"><span class="codicon codicon-symbol-field symbol-field"></span>joined_channel</h3>
<p>Type: optional <a href="#streammessageresponsejoinedchannel">protocol.voice.v1.StreamMessageResponse.JoinedChannel</a></p>
<p>Sent when joining a channel is successful</p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanuser_joined"><span class="codicon codicon-symbol-field symbol-field"></span>user_joined</h3>
<p>Type: optional <a href="#streammessageresponseuserjoined">protocol.voice.v1.StreamMessageResponse.UserJoined</a></p>
<p>Sent when another user joins the channel</p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanuser_left"><span class="codicon codicon-symbol-field symbol-field"></span>user_left</h3>
<p>Type: optional <a href="#streammessageresponseuserleft">protocol.voice.v1.StreamMessageResponse.UserLeft</a></p>
<p>Sent when another user leaves the channel</p>
<hr>
<h2 id="span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessageresponseinitialized"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageResponse.Initialized</h2>
<p><span class="h3" aria-level="3">Fields</span></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanrtp_capabilities-1"><span class="codicon codicon-symbol-field symbol-field"></span>rtp_capabilities</h3>
<p>Type: optional <code>string</code></p>
<hr>
<h2 id="span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessageresponsepreparedforjoinchannel"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageResponse.PreparedForJoinChannel</h2>
<p><span class="h3" aria-level="3">Fields</span></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanconsumer_transport_options"><span class="codicon codicon-symbol-field symbol-field"></span>consumer_transport_options</h3>
<p>Type: optional <a href="#transportoptions">protocol.voice.v1.TransportOptions</a></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanproducer_transport_options"><span class="codicon codicon-symbol-field symbol-field"></span>producer_transport_options</h3>
<p>Type: optional <a href="#transportoptions">protocol.voice.v1.TransportOptions</a></p>
<hr>
<h2 id="span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessageresponsejoinedchannel"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageResponse.JoinedChannel</h2>
<p><span class="h3" aria-level="3">Fields</span></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanother_users"><span class="codicon codicon-symbol-field symbol-field"></span>other_users</h3>
<p>Type: repeated <a href="#userconsumeroptions">protocol.voice.v1.UserConsumerOptions</a></p>
<hr>
<h2 id="span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessageresponseuserjoined"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageResponse.UserJoined</h2>
<p><span class="h3" aria-level="3">Fields</span></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspandata"><span class="codicon codicon-symbol-field symbol-field"></span>data</h3>
<p>Type: optional <a href="#userconsumeroptions">protocol.voice.v1.UserConsumerOptions</a></p>
<hr>
<h2 id="span-classcodicon-codicon-symbol-structure-symbol-structurespanstreammessageresponseuserleft"><span class="codicon codicon-symbol-structure symbol-structure"></span>StreamMessageResponse.UserLeft</h2>
<p><span class="h3" aria-level="3">Fields</span></p>
<h3 id="span-classcodicon-codicon-symbol-field-symbol-fieldspanuser_id-1"><span class="codicon codicon-symbol-field symbol-field"></span>user_id</h3>
<p>Type: optional <code>uint64</code></p>
<h1 id="services">Services</h1>
<h2 id="span-classcodicon-codicon-symbol-class-symbol-classspanvoiceservice"><span class="codicon codicon-symbol-class symbol-class"></span>VoiceService</h2>
<p>Harmony service for facilitating voice operations using WebRTC.</p>
<h1 id="usage-for-client">Usage (for client)</h1>
<ol start="0">
<li>Call StreamMessage to be able to send RTC commands to server</li>
<li>Send Initialize over stream with guild_id and channel_id of the request set to the channel you want to join</li>
<li>Init device by using the RTP capabilities sent in the response message, which should be Initialized</li>
<li>Send PrepareForJoinChannel over stream with client rtp capabilities</li>
<li>Wait for PreparedForJoinChannel, which contains transport options</li>
<li>Connect both transports using the transport options on client</li>
<li>Send JoinChannel over stream containing RTP paramaters for your Audio track
and DTLS paramaters for both consumer and producer</li>
<li>Wait for JoinedChannel, which confirms you have successfully joined the voice channel;
handle other_users which will be described in 8 (UserJoined handling)</li>
<li>Handle UserJoined and UserLeft events appropiately</li>
</ol>
<ul>
<li>For UserJoined; use the received consumer ID, producer ID and RTP parameters on your
consumer transport to consume the producer, afterwards send ResumeConsumer message
with the consumer ID, then if that&rsquo;s successful add the track to a <code>user ID -&gt; Track</code> map</li>
<li>For UserLeft, remove the user track from the <code>user ID -&gt; Track</code> map</li>
</ul>
<h2 id="how-this-looks-for-servers">How this looks for servers</h2>
<ol start="0">
<li>Receives StreamMessage, starts the socket</li>
<li>Waits for Initialize</li>
<li>Sends Initialized over stream with it&rsquo;s RTP capabilities</li>
<li>Receives PrepareForJoinChannel with client RTP capabilities</li>
<li>Sends PreparedForJoinChannel over stream with consumer and producer transport options</li>
<li>Receives JoinChannel, checks for DTLS parameters for consumer and producer transports
and uses the RTP paramaters to create a producer for the client</li>
<li>Sends JoinedChannel over stream with the created producer ID and all other users' data (UserData)</li>
<li>When another user does 1 to 7, sends UserJoined over stream to all other users;
when a user leaves the channel (when their stream ends), sends UserLeft to all other users</li>
<li>When receiving a ResumeConsumer message, unpauses the consumer corresponding to the consumer ID
<span class="h3" aria-level="3">Fields</span></li>
</ol>
<h4 id="span-classcodicon-codicon-symbol-method-symbol-methodspanstreammessage"><span class="codicon codicon-symbol-method symbol-method"></span>StreamMessage</h4>
<p>streaming <a href="#streammessagerequest">protocol.voice.v1.StreamMessageRequest</a> -&gt; streaming <a href="#streammessageresponse">protocol.voice.v1.StreamMessageResponse</a></p>
<p>Endpoint to stream messages between client and server.</p>
<ul>
<li>One StreamMessage stream corresponds to being in one voice channel.</li>
<li>It&rsquo;s recommended that users should not be able to be in more than one voice channel,
but this limitation is left up to the server implementation.</li>
</ul>

    </article>
  </div>
</div>


        </main><footer class="py-8 bg-light-900 dark:bg-dark-900 flex justify-center">
  <div class="max-w-prose">Harmony Development</div>
</footer>
</body>
</html>
